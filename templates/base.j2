{% extends "bootstrap/base.j2" %}

{% block head %}

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-QSM2MDFW8W"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag('js', new Date());

  gtag('config', 'G-QSM2MDFW8W');
</script>

<title class="h1">sc2DAT</title>
<link rel="shortcut icon" href="{{ url_for('static', filename='sc2targets.png') }}" />
<link rel="icon" href="{{ url_for('static', filename='sc2targets.png') }}">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="keywords"
  content="tumor, subtypes, rna-seq, cancer, proteomics, personalized, cancer, therapy, bioinformatics, cptac, phophosphoproteomics, targets, adc, car-t, immunotherapy">
<link href='https://fonts.googleapis.com/css?family=Open Sans' rel='stylesheet'>

<link rel="stylesheet" href="{{ url_for('static', filename='css/fontawesome.css') }}">
<style>
  .hidden {
    display: none;
  }

  input[type="submit"] {
    width: 30%;
    padding: 12px 20px;
    margin: 8px 0;
    box-sizing: border-box;
    background-color: rgb(0, 123, 255);
    color: white;
    border: 2px solid #ccc;
    -webkit-transition: 0.5s;
    transition: 0.5s;
    outline: none;
    border-radius: 20px;
    text-transform: uppercase;
    font-weight: bold;
  }

  input[type="submit"]:hover {
    background-color: rgb(0, 70, 175);
  }

  input[type="checkbox"]:hover {
    background-color: rgb(0, 70, 175);
  }

  .select2 {
    padding: 5px;
    border-radius: 15px;
    background-color: #f1f1f1;
  }

  .select2:hover {
    background-color: #e1e1e1;
  }

  input:checked+.object-label {
    background-color: #007bff;
    color: white;
    /*border-bottom-width: 1px;*/
  }

  input:checked+.object-label span {
    color: white;
  }

  input:checked+.object-label img.invert-selected {
    -webkit-filter: invert(100%);
  }

  input:checked+.radio-label {
    background-color: #007bff;
    color: white;
  }

  .border-black {
    border: 1px solid black !important;
  }

  .border-grey {
    border: 1px solid #c9c9c9;
  }

  .reset-button {
    border: 1px solid #c9c9c9 !important;
    background-color: transparent !important;
    font-weight: 200;
    font-size: small;
  }

  .border-custom {
    border: 1px solid #c9c9c9;
    border-bottom: 2px solid #d5d5d5;
  }

  .border-hover-blue:hover {
    border: 1px solid #3cb2f7 !important;
    border-bottom: 2px solid #3bb1f7 !important;
  }

  .border-black-custom {
    border: 1px solid black !important;
    border-bottom: 2px solid #8a8a8a !important;
  }

  .border-grey-light {
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .border-blue {
    border: 1px solid #007bff;
  }

  .border-none {
    border: none;
  }


  .btn-link:hover {
    background-color: #2baebd;
  }

  .custom-file {
    position: relative;
    display: inline-block;
    width: 100%;
    height: 180px !important;
    margin-bottom: 0;
  }

  .custom-file-input {
    position: relative;
    z-index: 2;
    width: 100%;
    height: 180px !important;
    margin: 0;
    overflow: hidden;
    opacity: 0;
  }

  .custom-file-label-test {
    position: absolute;
    top: 0;
    right: 0;
    left: 0;
    z-index: 1;
    height: 180px !important;
    padding: .375rem .75rem;
    overflow: hidden;
    font-weight: 400;
    line-height: 1.5;
    color: #495057;
    background-color: #efefef !important;
    border: 1px solid #a9a9a9 !important;
    border-radius: 30px 30px 30px 30px !important;
  }

  .footer {
    position: relative;
    bottom: 0;
    width: 100%;
    height: 100%;
    /* Set the fixed height of the footer here */
    line-height: 60px;
    /* Vertically center the text there */
  }

  .custom-file-label-test[for=rna_expr] {
    background-color: #2282a3 !important;
    color: white;
  }

  .custom-file-label-test[for=prot_expr] {
    background-color: #2282a3 !important;
    color: white;
  }

  .custom-file-label-test[for=phospho_expr] {
    background-color: #2282a3 !important;
    color: white;
  }

  .custom-file-label-test[for=meta] {
    background-color: #4c8c94 !important;
    color: white;
  }

  #submit-feedback {
    visibility: hidden;
    opacity: 0;
    transition: visibility 0s, opacity 0.5s linear;
    left: 0;
    right: 0;
    margin-left: auto;
    margin-right: auto;
    width: fit-content;
  }

  .tooltip-custom {
    position: relative;
    display: inline-block;
    border-bottom: 1px dotted black;
    /* If you want dots under the hoverable text */
  }

  /* Tooltip text */
  .tooltip-custom .tooltiptext-custom {
    visibility: hidden;
    width: 250px;
    background-color: rgba(97, 97, 97, 0.927);
    color: #fff;
    text-align: start;
    padding: 5px;
    border-radius: 6px;
    font-size: 12px;
    white-space: pre-wrap;

    /* Position the tooltip text - see examples below! */
    position: absolute;
    display: inline-block;
    z-index: 10;
  }

  /* Show the tooltip text when you mouse over the tooltip container */
  .tooltip-custom:hover .tooltiptext-custom {
    visibility: visible;
  }

  body {
    padding: 0 !important;
    background: linear-gradient(rgb(209, 255, 229), rgb(231, 255, 239)) !important;
  }

  .inner_cell+#abstract {
    border: 2px solid #595959;
    background-color: #F2FAFC;
    padding: 10px;


  }

  .question {
    font-weight: light; 
    border: solid 2px gray; 
    padding: 20px; 
    border-radius: 10px; 
    font-size: larger;
    transition: all 500ms;
    cursor: pointer;
  }

  :hover.question {
    font-weight: bolder !important; 
    border: solid 2px black; 
    background-color: rgb(155, 219, 155);
  }

  .selected {
    font-weight: bolder !important; 
    border: solid 2px black !important; 
    background-color: rgb(173, 236, 173);
  }

  div.cell {
    padding: 0 !important;
    text-align: justify !important;
  }

  .rendered_html p {
    text-align: justify !important;
  }

  #notebook {
    padding-top: 0px !important;
  }

  .cancer-example {
    cursor: pointer;
  }

  .cancer-example:hover {
    background-color: rgba(177, 229, 255, 0.784);
    border-radius: 20px;
    transition: all 1s;
  }

  .button-custom {
    background-color: #2283a300;
    color: #2c2c2c;
    border: 1px solid #545454;
    border-radius: 5px;
    padding: 2px 5px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
    margin: 4px 2px;
    cursor: pointer;
  }

  .all-examples {
    background-color: #2283a300;
    color: #2282a3;
    border: 1px solid #2282a3;
    border-radius: 5px;
    padding: 2px 5px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
    margin: 4px 2px;
    cursor: pointer;
    font-weight: lighter;
  }
</style>

{% endblock %}

{% block body %}
<div class="row justify-content-center mb-3"
  style="position: relative; width: 105%; left: -3%; font-family: 'Open Sans'; background-color: rgb(208, 255, 223); border-bottom: 2px solid #006bdd; overflow-x: visible;">
  <div class="container col-12">
    <div class="mb-1 mt-2 mx-0 row align-items-center text-left flex-row" style="position: relative; margin-right: 20%">
      <div class="col-2">
        <a href="/">
          <img src="{{ url_for('static', filename='sc2targets.png') }}" style="width:175px" class="img-fluid float-right">
        </a>
      </div>
      <div class="col-3 col-sm-4 text-left">
         <h1 style="font-weight: 500">sc2DAT</h1>
         <h3 style="font-weight: 500"> scRNA-seq 2 Drugs and Targets </h3>
        <p class="my-0">
          Upload a single cell RNA-seq matrix or a bulk RNA-seq matrix with and select a
          corresponding single cell reference to identify cell-surface targets and L1000 compounds.
        </p>
      </div>

      <div class="col-2">
        <img src="{{ url_for('static', filename='ISMMS_black.png') }}" style="width:200px;" class="img-fluid">
      </div>
      <div class="col-2 col-sm-2">
        <img src="{{ url_for('static', filename='maayan-black.png') }}" style="width: 150px;"
          class="mt-4 ml-5 img-fluid">
      </div>
      <div class="col-1 text-center ml-5">
        Executed Reports: <p style="font-weight: 1200; font-size: 1.5rem" id="numruns"></p>
      </div>
    </div>
  </div>
</div>

{{ super() }}
{% endblock %}

{% block script %}
{{ super() }}

<script>

  function waitForElementToDisplay(selector, callback, checkFrequencyInMs, timeoutInMs) {
    var startTimeInMs = Date.now();
    (function loopSearch() {
      if (document.querySelector(selector) != null) {
        callback();
        return;
      }
      else {
        setTimeout(function () {
          if (timeoutInMs && Date.now() - startTimeInMs > timeoutInMs)
            return;
          loopSearch();
        }, checkFrequencyInMs);
      }
    })();
  }

  function enableDropdown() {
    const dropDown = document.getElementsByClassName('dropdown-toggle');
    if (dropDown.length != 0) {
      for (let j = 0; j < dropDown.length; j++) {
        dropDown[j].addEventListener('click', function () {
          const dropDownMenu = document.getElementsByClassName('dropdown-menu');
          if (dropDownMenu[j].style.display === 'none' || dropDownMenu[j].style.display === '') {
            dropDownMenu[j].style.display = 'block';
          } else {
            dropDownMenu[j].style.display = 'none';
          }
        });
      }
    }

    const dropDownItems = document.getElementsByClassName('dropdown-item');
    for (let i = 0; i < dropDownItems.length; i++) {
      dropDownItems[i].addEventListener('click', function () {
        const dropDownMenu = document.getElementsByClassName('dropdown-menu');
        dropDownMenu[0].style.display = 'none';
        dropDownMenu[1].style.display = 'none';
      });
    }
  }

  function styleAbstract() {
    const abstractElt = document.getElementById('abstract');
    var abstractBox = abstractElt.parentElement
    for (let i = 0; i < 6; i++) {
      abstractBox = abstractBox.parentElement;
    }
    document.getElementById('output-prompt-5-1').style.display = 'none';
    document.getElementById('output-prompt-5-0').style.display = 'none';
    abstractBox.lastElementChild.lastElementChild.lastElementChild.classList = '';

    abstractBox.style.border = '2px solid #595959';
    abstractBox.style.backgroundColor = '#F2FAFC'
    abstractBox.style.padding = '10px';
    abstractBox.style.paddingRight = '10px';
    abstractBox.style.paddingLeft = '10px';
    abstractBox.style.marginLeft = '10%';
    abstractBox.style.color = 'black';

  }
  waitForElementToDisplay(".dropdown-menu", enableDropdown, 500, 10000);
  waitForElementToDisplay("#abstract", styleAbstract, 500, 100000);


  function downloadCitation() {
    const element = document.createElement('a');
    const citation = "URL: " + window.location.href
    const file = new Blob([citation], {
      type: 'text/plain'
    });
    element.href = URL.createObjectURL(file);
    element.download = 'citation.txt';
    document.body.appendChild(element); // Required for this to work in FireFox
    element.click();
  }

  function getNumRuns() {
    fetch('/blueprint/numruns').then(response => response.json()).then(data => {
      document.getElementById('numruns').innerText = data.num_runs;
    })
  }
  getNumRuns()

</script>
{% endblock %}

{% block footer %}
<footer class="footer mt-5">
  <div class="d-flex"
    style="position:absolute;width: 104%; left: -3%; background-color:rgb(48, 98, 245); padding: 0px; overflow-x: hidden;">
    <div class="row justify-content-around align-items-center text-center my-3 mx-auto">
      <div class="col  ml-5 mx-5" style="font-size: medium;">
        <a class="btn-link mr-2 text-nowrap" href="mailto:avi.maayan@mssm.edu" target="_blank" style="color: white !important;
          text-decoration: none !important;
          border-style: solid;
          padding: 8px;
          border-color: white;
          border-radius: 10px;
          border-width: 1px;">Contact Us</a>

        <a class="btn-link text-nowrap" href="https://github.com/MaayanLab/SC2Targets" target="_blank"
          rel="noopener noreferrer" style="color: white !important;
            text-decoration: none !important;
            border-style: solid;
            padding: 8px;
            border-color: white;
            border-radius: 10px;
            border-width: 1px;">
          Source Code
        </a>
      </div>
      <div class="col mx-5">
        <a href="https://labs.icahn.mssm.edu/" target="_blank" rel="noopener noreferrer">
          <img src="{{ url_for('static', filename='ismms_white.png')}}" style="width: 8rem;" alt='Ma&apos;ayan Lab' />
        </a>
      </div>

      <div class="col mx-5">
        <a href="https://labs.icahn.mssm.edu/maayanlab/" target="_blank" rel="noopener noreferrer">
          <img class='rounded pt-3' src="{{ url_for('static', filename='maayanlab_white.png')}}" style="width: 8rem;"
            alt='Ma&apos;ayan
            Lab' />
        </a>
      </div>
      <div class="col mx-5">
        <a class="mr-5" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">
          <img src="{{ url_for('static', filename='cc-by-nc-sa.png')}}" style="width: 8rem;" alt="CC-by-NC-SA" />
        </a>
      </div>

    </div>


  </div>
</footer>

{% endblock %}